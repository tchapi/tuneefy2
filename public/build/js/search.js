"use strict";var search;$(document).ready(function(){var a="tuneefyPrefs",s="tuneefyHelpBox",t="tuneefySearchType",n=$("#find"),l=$("#query"),i=l.attr("data-placeholder"),r=$("#launch"),o=$("#aggressive"),c=$("#searchTypeCheckbox"),d=$("#options"),h=$("#advanced,#hideMisere"),u=$("a.btns"),e=$(".searchForIt"),p=$("#alerts"),f=$("span.closeHelp"),m=$("span.closeForever"),v=$("#resetQuery"),g=$("#results"),k=$("#results ul"),C=$(".nbResults"),b=$("#waiting"),y=($("a.tPagerNext img, a.tPagerPrev img, .tPagerPage"),""),P=(r.removeAttr("disabled"),u.removeAttr("on"),"function"==typeof $.iphoneStyle&&(o.iphoneStyle({checkedLabel:o.attr("data-yes"),uncheckedLabel:o.attr("data-no"),resizeContainer:!1,resizeHandle:!1}),c.iphoneStyle({checkedLabel:"",uncheckedLabel:"",resizeContainer:!1,resizeHandle:!1,containerClass:"iPhoneCheckContainer otherContainer",labelOnClass:"iPhoneCheckLabelOn albums",labelOffClass:"iPhoneCheckLabelOff tracks",handleClass:"iPhoneCheckHandle otherHandle",handleCenterClass:"iPhoneCheckHandleCenter noBG",handleRightClass:"iPhoneCheckHandleRight activeTracks",containerRadius:2,onChange:function(){var e=c.is(":checked")?($("#typeTracks").removeClass("off"),$("#typeAlbums").addClass("off"),$(".iPhoneCheckHandleRight.activeAlbums").addClass("activeTracks"),$(".iPhoneCheckHandleRight.activeAlbums").removeClass("activeAlbums"),t+"=tracks; "):($("#typeTracks").addClass("off"),$("#typeAlbums").removeClass("off"),$(".iPhoneCheckHandleRight.activeTracks").addClass("activeAlbums"),$(".iPhoneCheckHandleRight.activeTracks").removeClass("activeTracks"),t+"=albums; ");e+="expires=Sat, 01 Feb 2042 01:20:42 GMT; path=/; domain= "+$DOMAIN+";",document.cookie=e}})),$(document).on("click",".closeAlert",function(){$(this).parent().fadeOut()}),document.cookie.split(a+"=")[1]||""),y=P=""===P?$default_platforms:decodeURIComponent(P.split(";")[0]),T=P.split(","),w=($.each(T,function(e,t){$("#platform_"+t).attr("on","yes").removeClass("off")}),null!==(P=document.cookie.split(t+"=")[1]||"")&&"albums"===P.split(";")[0]&&c.click(),search=function(e,t,s){console.log("Searching for "+s.itemType+"s with query '"+t+"' on "+s.selectedPlatforms+" (strict: "+s.strictMode+").");var a={q:t,aggressive:s.strictMode,include:s.selectedPlatforms,limit:s.limit||10};e=e+"?"+$.param(a),$.get({url:e,crossDomain:!0,beforeSend:function(e){e.setRequestHeader("X-Requested-With","XMLHttpRequest")},xhrFields:{withCredentials:!0}}).done(function(a){if(a.errors&&0<a.errors.length){for(var e=0;e<a.errors.length;e++)console.log(a.errors),p.append("<span class='alert' ><div class=\"triangle\"></div>"+Object.values(a.errors[e])[0]+"<span class='closeAlert'></span></span>");p.children().last().fadeIn()}a.results?(s.updateNumberLabel&&C.html($results_found.replace("%query%",t).replace("%type%",s.itemType).replace("%number%",a.results.length)),$(".tHeader_disp[rel="+s.itemType+"]").show(),Twig.twig({href:"build/js/twig/result.html.twig",async:!0,load:function(e){for(var t in a.results){t=a.results[t];k.append(e.render({type:s.itemType,item:t.musical_entity,intent:t.share.intent,share:$share,listenTo:$listen_to.replace("%name%",t.musical_entity.safe_title),shareTip:$share_tip.replace("%name%",t.musical_entity.safe_title),linkDirect:$path,linkIntent:$pathIntent,compact:!0}))}g.show()}})):(p.append("<span class='alert' ><div class=\"triangle\"></div>"+$error_message+"<span class='closeAlert'></span></span>"),p.children().last().fadeIn())}).fail(function(){p.append("<span class='alert' ><div class=\"triangle\"></div>"+$error_message+"<span class='closeAlert'></span></span>"),p.children().last().fadeIn()}).always(function(){b.hide(),r.removeAttr("disabled"),l.blur(),0<k.length&&$("html,body").animate({scrollTop:k.offset().top-20},"slow")})},n.submit(function(e){e.preventDefault(),$(".hideAll").fadeOut(),h.hide(),d.removeClass("shd");var t,e=$.trim(l.val()),a=o.is(":checked"),s=c.is(":checked")?"track":"album";return""!==e&&e!==i&&""!==y&&(r.attr("disabled","disabled"),g.hide(),k.find(".tResult").remove(),b.show(),p.empty(),$(".tHeader_disp").hide(),t=n.attr("action").replace("_TYPE_",s),search(t,e,{itemType:s,selectedPlatforms:y,strictMode:a,updateNumberLabel:!0})),!1}),l.click(function(e){l.val()===i&&l.val(""),$(e.target).select(),$("#basic").addClass("focused"),$(".hideAll").fadeTo(500,.5),null===document.cookie.split(s+"=")[1]&&$("#help").fadeIn(),e.stopPropagation()}),e.click(function(e){l.val($(e.target).html()),n.submit()}),l.keyup(function(){l.val()!==i&&0!==$.trim(l.val()).length?v.show():v.hide()}),v.click(function(e){l.val(""),l.focus(),v.hide(),e.stopPropagation()}),f.click(function(e){$("#help").fadeOut(),l.focus(),e.stopPropagation()}),m.click(function(e){var t=s+"=neverAgain; ";t+="expires=Sat, 01 Feb 2042 01:20:42 GMT; path=/; domain= "+$DOMAIN+";",document.cookie=t,$("#help").fadeOut(),l.focus(),e.stopPropagation()}),d.click(function(e){h.toggle(),d.toggleClass("shd"),e.stopPropagation()}),$(".hideAll").click(function(){}),$("html").click(function(){h.hide(),d.removeClass("shd"),$("#basic").removeClass("focused"),$(".hideAll").fadeOut(),$("#help").fadeOut(),""===l.val()&&l.val(i)}),h.click(function(e){e.stopPropagation()}),u.click(function(e){"yes"===$(e.target).attr("on")?($(e.target).attr("on","no"),$(e.target).addClass("off")):($(e.target).attr("on","yes"),$(e.target).removeClass("off"));var t=[],e=(u.each(function(){"yes"===$(this).attr("on")&&t.push($(this).attr("rel"))}),y=t.toString(),a+"="+encodeURIComponent(y)+"; expires=Sat, 01 Feb 2042 01:20:42 GMT; path=/; domain= "+$DOMAIN+";");document.cookie=e}),$(document).on("click",".sharePage",function(){var e=$(this).attr("data-href");$.get({url:e,crossDomain:!0,beforeSend:function(e){e.setRequestHeader("X-Requested-With","XMLHttpRequest")},xhrFields:{withCredentials:!0}}).done(function(e){e.link&&(window.location.href=e.link)}).fail(function(){}).always(function(){})}),$(".pick")),A=$(".pickPagerItem");0<A.length&&A.first().addClass("active"),1<w.length&&setInterval(function(){var e=w.filter(":visible"),t=A.filter(".active"),a=e.next(),s=t.next();0==a.length&&(a=w.first(),s=A.first()),a.css("left","400px"),a.show(),a.animate({left:"30px"},"slow"),e.animate({left:"-300px"},"slow"),e.fadeOut("slow"),t.removeClass("active"),s.addClass("active")},4e3)});